<?xml version="1.0" encoding="UTF-8"?>
<queries>
    <query id="GASTOS_SELECT_ALL"><![CDATA[
        SELECT * FROM GASTOS gast
    ]]></query>

    <!-- Selecciona todos los gastos asociados a una cita usando la tabla intermedia -->
    <query id="GASTOS_SELECT_CITAID"><![CDATA[
        SELECT gast.*
        FROM GASTOS gast
        INNER JOIN movimientos_asociaciones mvas
            ON mvas.movimiento_id = gast.id
            AND mvas.tipo_movimiento = 'GASTO'
        WHERE mvas.tipo_entidad = 'CITAS'
            AND mvas.entidad_id = ?
    ]]></query>

    <query id="GASTOS_INSERT"><![CDATA[
        INSERT INTO GASTOS (descripcion, importe, fecha, observaciones)
        VALUES (?, ?, ?, ?)
    ]]></query>

    <query id="GASTOS_UPDATE"><![CDATA[
        UPDATE GASTOS
        SET descripcion = ?, importe = ?, fecha = ?, observaciones = ?
        WHERE id = ?
    ]]></query>

    <query id="GASTOS_DELETE"><![CDATA[
        DELETE FROM GASTOS WHERE id = ?
    ]]></query>

    <query id="GASTOS_INSERT_CITA_RELACION"><![CDATA[
        INSERT INTO movimientos_asociaciones (tipo_movimiento, movimiento_id, tipo_entidad, entidad_id, observaciones)
        VALUES ('GASTO',?,'CITAS',?,?)
    ]]></query>

    <query id="TOAL_GASTADO"><![CDATA[
        SELECT SUM(importe) AS total_gastos FROM gastos;
    ]]></query>
</queries>
